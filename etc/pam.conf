# ---------------------------------------------------------------------------#
# /etc/pam.conf								     #
#									     #
# Last modified by Andrew G. Morgan <morgan@kernel.org>		             #
# ---------------------------------------------------------------------------#
# $Id: pam.conf,v 1.2 2001/04/08 06:02:33 agmorgan Exp $
# ---------------------------------------------------------------------------#
# serv.	module	   ctrl	      module [path]	...[args..]		     #
# name	type	   flag							     #
# ---------------------------------------------------------------------------#

#
# The PAM configuration file for the `squid' service
#
squid   auth       [success=3 default=ignore] pam_succeed_if.so quiet user ingroup fullwebaccess
squid   auth       required   pam_succeed_if.so quiet user notingroup nowebaccess
squid   auth       required   pam_succeed_if.so quiet user notingroup mailbox
squid   auth       required   pam_succeed_if.so quiet user notingroup pctrust
squid   auth       sufficient pam_winbind.so cached_login
squid   auth       required   pam_ldap.so
squid   account    required   pam_permit.so
#
# The PAM configuration file for the `e4l' service
#
#e4l	auth       sufficient pam_winbind.so cached_login
#e4l	auth       required   pam_ldap.so
#e4l     session    required   pam_mkhomedir.so skel=/etc/skel umask=0022

#
# The PAM configuration file for the `ftp' service
#
ftp	auth       sufficient pam_winbind.so cached_login
ftp	auth       required   pam_ldap.so
ftp	account    required   pam_permit.so
ftp     session    required   pam_mkhomedir.so skel=/etc/skel umask=0022

#
# The PAM configuration file for the `httpd' service
#
httpd	auth       sufficient pam_winbind.so cached_login
httpd	auth       required   pam_ldap.so
httpd   account    required   pam_permit.so
httpd   session    required   pam_mkhomedir.so skel=/etc/skel umask=0022

#
# The PAM configuration file for the `radius' service
#
radiusd	auth       sufficient pam_ldap.so
radiusd	auth       required   pam_winbind.so cached_login
radiusd account    required   pam_permit.so
radiusd session    required   pam_mkhomedir.so skel=/etc/skel umask=0022

#
# The PAM configuration file for the `imap' service
#
imap	auth       sufficient pam_winbind.so cached_login
imap	auth       required   pam_ldap.so
imap    auth       required   pam_succeed_if.so uid >= 500
imap	account    required   pam_permit.so
imap    session    required   pam_mkhomedir.so skel=/etc/skel umask=0022

sogo-imap	auth       sufficient pam_permit.so
sogo-imap	auth       required   pam_succeed_if.so uid >= 500
sogo-imap	account    required   pam_permit.so
sogo-imap	session    required   pam_mkhomedir.so skel=/etc/skel umask=0022

kde	auth       sufficient pam_winbind.so cached_login
kde	auth       required   pam_ldap.so
kde	account    required   pam_permit.so
kde     session    required   pam_mkhomedir.so skel=/etc/skel umask=0022

#
# The PAM configuration file for the `ldap' service
#
ldap   auth       sufficient pam_winbind.so cached_login
ldap   auth       required   pam_ldap.so
ldap   account    required   pam_permit.so
ldap   session    required   pam_mkhomedir.so skel=/etc/skel umask=0022

#
# The PAM configuration file for the `pop3' service
#
pop3    auth       sufficient pam_winbind.so cached_login
pop3    auth       required   pam_ldap.so
pop3    auth       required   pam_succeed_if.so uid >= 500
pop3    account    required   pam_permit.so
pop3    session    required   pam_mkhomedir.so skel=/etc/skel umask=0022

#
#Hylafax PAM
#
hylafax	auth       sufficient pam_winbind.so cached_login
hylafax	auth       required   pam_ldap.so
hylafax	account    required   pam_permit.so
hylafax session    required   pam_mkhomedir.so skel=/etc/skel umask=0022


screen  auth       sufficient pam_unix.so
screen	auth       sufficient pam_winbind.so cached_login
screen	auth       required   pam_ldap.so
screen	account    required   pam_permit.so
screen  session    required   pam_mkhomedir.so skel=/etc/skel umask=0022

#
# The PAM configuration file for the `smtp' service
#
smtp	auth       sufficient pam_winbind.so cached_login
smtp	auth       required   pam_ldap.so
smtp	account    required   pam_permit.so
smtp    session    required   pam_mkhomedir.so skel=/etc/skel umask=0022

#
# The PAM configuration file for the `sshd' service
#
sshd    auth       [success=3 default=ignore] pam_unix.so
sshd    auth       [success=2 default=ignore] pam_winbind.so cached_login
sshd    auth       [success=1 default=ignore] pam_ldap.so
sshd	auth       requisite  pam_deny.so
sshd    auth       required   pam_ecryptfs.so unwrap
sshd    account    required   pam_permit.so
sshd    session    required   pam_mkhomedir.so skel=/etc/skel umask=0022
sshd    session    optional   pam_ecryptfs.so unwrap

#
# The PAM configuration file for the `netatalk' service
#
netatalk	auth       sufficient pam_winbind.so cached_login
netatalk	auth       required   pam_ldap.so
netatalk        account    required   pam_permit.so
netatalk        session    required   pam_mkhomedir.so skel=/etc/skel umask=0022

#
# The PAM configuration file for the `samba' service
#
samba	 auth       sufficient   pam_winbind.so cached_login
samba	 auth       required     pam_ldap.so
samba    account    required     pam_permit.so
samba    session    required     pam_mkhomedir.so skel=/etc/skel umask=0022

#
# The PAM configuration file for the `login' service
#

login   auth       [success=3 default=ignore] pam_unix.so
login   auth       [success=2 default=ignore] pam_winbind.so cached_login
login   auth       [success=1 default=ignore] pam_ldap.so
login	auth       requisite  pam_deny.so
login	auth       optional   pam_group.so
login	auth       requisite  pam_securetty.so
login   auth       required   pam_ecryptfs.so unwrap
login	account    requisite  pam_time.so
login	account    optional   pam_unix.so
login   account    required   pam_permit.so
login	session    optional   pam_ecryptfs.so unwrap
login   session    required   pam_mkhomedir.so skel=/etc/skel umask=0022
login	session    required   pam_unix.so

#login	password   required   pam_unix.so shadow md5 use_authtok

remote  auth       [success=3 default=ignore] pam_unix.so
remote  auth       [success=2 default=ignore] pam_winbind.so cached_login
remote  auth       [success=1 default=ignore] pam_ldap.so
remote	auth       requisite  pam_deny.so
remote  auth       optional   pam_group.so
remote  auth       requisite  pam_securetty.so
remote  auth       required   pam_ecryptfs.so unwrap
remote  account    requisite  pam_time.so
remote  account    optional   pam_unix.so
remote  account    required   pam_permit.so
remote  session    optional   pam_ecryptfs.so unwrap
remote  session    required   pam_mkhomedir.so skel=/etc/skel umask=0022
remote  session    required   pam_unix.so

#
# The PAM configuration file for the `other' service
#
other	auth       required   pam_deny.so
other	auth       required   pam_warn.so
other	account    required   pam_deny.so
other	password   required   pam_deny.so
other	password   required   pam_warn.so
other	session    required   pam_deny.so
#
# The PAM configuration file for the `passwd' service
#
passwd	password   required   pam_unix.so shadow md5 use_authtok

#
# The PAM configuration file for the `rexec' service
#
rexec	auth       requisite  pam_securetty.so
rexec	auth       requisite  pam_nologin.so
rexec	auth       sufficient pam_rhosts_auth.so
rexec	auth       required   pam_unix.so
rexec	account    required   pam_unix.so
rexec	session    required   pam_unix.so
rexec	session    required   pam_limits.so
#
# The PAM configuration file for the `rlogin' service
# this application passes control to `login' if it fails
#
rlogin	auth       requisite  pam_securetty.so
rlogin	auth       requisite  pam_nologin.so
rlogin	auth       required   pam_rhosts_auth.so
rlogin	account    required   pam_unix.so
rlogin	password   required   pam_unix.so shadow md5 use_authtok
rlogin	session    required   pam_unix.so
rlogin	session    required   pam_limits.so
#
# The PAM configuration file for the `rsh' service
#
rsh	auth       requisite  pam_securetty.so
rsh	auth       requisite  pam_nologin.so
rsh	auth       sufficient pam_rhosts_auth.so
rsh	auth       required   pam_unix.so
rsh	account    required   pam_unix.so
rsh	session    required   pam_unix.so
rsh	session    required   pam_limits.so
#
# The PAM configuration file for the `su' service
#
su	auth       required   pam_wheel.so
su	auth       sufficient pam_rootok.so
su	auth       required   pam_unix.so
su	account    required   pam_unix.so
su	session    required   pam_unix.so
#
# The PAM configuration file for the `vlock' service
#
vlock	auth       required   pam_unix.so
#
# The PAM configuration file for the `xdm' service
#
xdm	auth       required   pam_unix.so
xdm	account    required   pam_unix.so
#
# The PAM configuration file for the `xlock' service
#
xlock	auth       required   pam_unix.so

#
# The PAM configuration file for the `chfn' service
#
chfn	auth       required   pam_unix.so
chfn	account    required   pam_unix.so
chfn	password   required   pam_unix.so shadow md5 use_authtok
#
# The PAM configuration file for the `chsh' service
#
chsh	auth       required   pam_unix.so
chsh	account    required   pam_unix.so
chsh	password   required   pam_unix.so shadow md5 use_authtok
